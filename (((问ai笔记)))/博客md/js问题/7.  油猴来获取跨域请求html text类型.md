## ==7.== 油猴来获取跨域请求html/text类型

>  正在为您搜索：页面https://www.jianfast.com/通过油猴来获取跨域请求html/text类型可以吗、帮我写一个demo
>
> 根据知识来源[1]中描述，"简法主页"是一个可以自定义搜索引擎的网站，并且没有提到它允许跨域请求，因此无法确切判断它是否可以通过油猴来获取跨域请求html/text类型。如果您要获取百度主页（https://www.baidu.com/）的html/text类型响应，可以使用以下代码作为参考：
>
> ```javascript
> // ==UserScript==
> // @name     Get Baidu HTML by Cross-Domain Request
> // @version  1
> // @grant    GM_xmlhttpRequest
> // ==/UserScript==
>
> GM_xmlhttpRequest({
>     method: 'GET',
>     url: 'https://www.baidu.com/',
>     onload: function(response) {
>         console.log(response.responseText);
>     }
> });
> ```
>
> 这个油猴脚本会在安装后向百度主页发送一个GET请求，然后通过控制台输出响应文本。需要注意的是，有些网站可能不允许跨域请求，这时候就不能通过油猴获取跨域请求的html/text。
>
>
>
>  **GM_xmlhttpRequest是？**
>
> >`GM_xmlhttpRequest`是一个特定于油猴（Tampermonkey）的XMLHttpRequest对象，用于发起跨域http/https请求和获取响应[[1](https://www.tampermonkey.net/documentation.php#_gm_xmlhttprequest)]。该对象并非标准浏览器内置的XMLHttpRequest对象，而是油猴为了方便脚本编写者进行跨域请求而提供的一个扩展。与普通的XMLHttpRequest对象相比，`GM_xmlhttpRequest`的使用方法基本相同，但它可以处理跨域请求、包括对https协议的支持，并提供更方便的回调函数，如onload、onerror等。另外需要注意的是，一些高保护级别的Chrome浏览器（如Google Chrome 87及以上版本）已经禁止了GM_xmlhttpRequest的使用，如果需要使用跨域请求，请使用GM.fetch()函数[[2](https://www.jianshu.com/p/f880878c1398)]。
>
>
>
> **这段代码放在油猴里面会，进入页面是运行一次还是一直运行的**
>
> >```	javascript
> >    GM_xmlhttpRequest({
> >        method: 'GET',
> >        url: 'https://www.douyin.com/user/MS4wLjABAAAAcOogp8WSlLvXNTPUg9b9brwWXQj76F9qeckY4T4w3kOzyuAMP-BFj2SbGqwIYwSZ?vid=7219194157544377637',
> >        onload: function(response) {
> >            //console.log(response.responseText);
> >            // 处理返回结果
> >            let data = response.responseText;
> >            let parser = new DOMParser();
> >            let doc = parser.parseFromString(data, "text/html");
> >            let element = doc.querySelector("p.iQKjW6dr");
> >            document.getElementsByClassName("site-title")[0].innerText=element.textContent;
> >        }
> >```
> >
> >>该代码片段只会在页面加载时运行一次
> >
> >
> >
> >**报错（不影响使用）Unchecked runtime.lastError: The message port closed before a response was received.**
> >
> >>这个错误是由于Chrome浏览器对于扩展的代码执行时间做了限制，如果超过了一定时间（通常为10秒），则会被认为是未响应的代码，从而被Chrome自动终止。当您尝试在油猴脚本中请求一个较慢的URL时，可能会遇到这个错误。解决这个问题的方法有：
> >>
> >>1. 缩短代码执行时间：优化您的代码，尽量减少需要花费大量时间的操作和网络请求，从而缩短代码执行时间。
> >>
> >>2. 延长超时时间：在油猴脚本中使用GM.xmlHttpRequest()发起请求时，可以设置timeout属性来延长请求的超时时间。例如：
> >>
> >>   ```javascript
> >>   GM.xmlHttpRequest({
> >>      method: "GET",
> >>      url: "https://www.example.com",
> >>      headers: {
> >>         "User-Agent": "Mozilla/5.0", //模拟浏览器请求
> >>         "Accept-Language": "zh-CN,zh;q=0.9" //设置接受语言
> >>      },
> >>      timeout: 20000, //延长请求超时时间（单位：毫秒）
> >>      onload: function(response) {
> >>          console.log(response.responseText);
> >>      }
> >>   });
> >>   ```
> >>
> >>   在上述代码中，timeout属性设置为20000，即20秒，表示请求的超时时间为20秒。如果在20秒内请求没有得到响应，将会触发onerror回调函数。
> >>
> >>3. 禁用油猴的自动更新：在某些情况下，油猴的自动更新会导致脚本执行时间过长，从而触发上述错误。您可以禁用油猴的自动更新功能，在油猴的设置中关闭“自动更新脚本”选项。
> >>



==8.== && || ?? 的区别

> `&&`，`||` 和 `??` 都是 JavaScript 中的逻辑操作符，但它们的行为有所不同：
> - `&&` （逻辑与）：如果左操作数为真（truthy），则返回右操作数的值。如果左操作数为假（falsy），则返回左操作数的值。比如 `false && "ikun"` 返回 `false`，因为 `false` 是 falsy。
> - `||` （逻辑或）：如果左操作数为真（truthy），则返回左操作数的值。如果左操作数为假（falsy），则返回右操作数的值。比如 `false || "ikun"` 返回 `"ikun"`，因为 `false` 是 falsy。
> - `??` （空值合并）：如果左操作数为 `null` 或 `undefined`，则返回右操作数的值。否则，返回左操作数的值。比如 `false ?? "ikun"` 返回 `false`，因为 `false` 不是 `null` 或 `undefined`。
> 所以，`&&` 和 `||` 操作符与 `??` 的主要区别在于它们如何处理 falsy 值。对于 `&&` 和 `||`，所有 falsy 值（如 `false`、`0`、`""`、`null`、`undefined` 和 `NaN`）都会导致操作数被忽略。但是，对于 `??`，只有 `null` 和 `undefined` 会导到操作数被忽略。




